<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</title>
  <style>
    :root { --bg:#f6f7f9; --card:#fff; --border:#e6e8ec; --text:#1f2328; --muted:#6b7280; --ring:#93c5fd; --primary:#1f6feb; --primary-600:#1a5fd3; }
    body { font-family: Inter, system-ui, Arial, sans-serif; background:var(--bg); margin:0; color:var(--text); }
    .container { max-width: 1100px; margin: 24px auto; background:var(--card); border-radius:16px; padding:20px; box-shadow:0 10px 30px rgba(0,0,0,.06) }
    header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px; }
    .title { margin:0; font-size:20px; font-weight:700; }
    .toolbar { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .btn { display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:10px; font-weight:600; text-decoration:none; cursor:pointer; line-height:1; border:1px solid transparent; }
    .btn:focus-visible { outline:3px solid var(--ring); outline-offset:2px; }
    .btn-primary { background:var(--primary); color:#fff; }
    .btn-primary:hover { background:var(--primary-600); }
    .btn-outline { background:#fff; color:var(--text); border-color:var(--border); }
    .btn-outline:hover { background:#fafafa; }
    .icon { font-size:16px; }

    .grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:16px; }
    .card { border:1px solid var(--border); border-radius:12px; padding:12px; background:#fcfdff; display:flex; flex-direction:column; gap:8px }
    .thumb { height:160px; display:flex; align-items:center; justify-content:center; background:#fff; border:1px dashed #e2e6ee; border-radius:10px }
    .thumb img { max-width:100%; max-height:100%; object-fit:contain }
    .muted { color:var(--muted); font-size:12px; }
    .title2 { font-weight:700; }
    @media (max-width: 1024px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h2 class="title">–ò—Å—Ç–æ—Ä–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</h2>
      <nav class="toolbar" aria-label="–î–µ–π—Å—Ç–≤–∏—è">
        <a class="btn btn-primary" href="{{ url_for('index') }}" title="–ù–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è">
          <span class="icon">‚ûï</span><span>–ù–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</span>
        </a>
      </nav>
    </header>

    {% if not batches %}
      <p class="muted">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.</p>
    {% else %}
      <div class="grid">
        {% for b in batches %}
        <div class="card">
          <div class="thumb">
            {% if b.cover_rel %}
              <img src="{{ url_for('static', filename=b.cover_rel) }}" alt="cover">
            {% else %}<span class="muted">–ù–µ—Ç –ø—Ä–µ–≤—å—é</span>{% endif %}
          </div>
          <div class="title2">{{ b.batch_id }}</div>
          <div class="muted">{{ b.created_at }} ‚Ä¢ {{ '—Ç–µ–∫—Å—Ç' if b.input_type=='text' else '–∫–∞—Ä—Ç–∏–Ω–∫–∞' }} ‚Ä¢ {{ b.items_count }} –º–æ–¥–µ–ª–µ–π</div>
          {% if b.prompt %}
            <div class="muted">¬´{{ b.prompt[:80] }}{% if b.prompt|length > 80 %}‚Ä¶{% endif %}¬ª</div>
          {% endif %}
          <div style="display:flex; gap:10px; margin-top:6px;">
            <a class="btn btn-outline" href="{{ url_for('view_batch', batch_id=b.batch_id) }}" title="–û—Ç–∫—Ä—ã—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç">
              <span class="icon">üëÅÔ∏è</span><span>–û—Ç–∫—Ä—ã—Ç—å</span>
            </a>
            <a class="btn btn-outline" href="{{ url_for('download_batch', batch_id=b.batch_id) }}" title="–°–∫–∞—á–∞—Ç—å –≤–µ—Å—å –±–∞—Ç—á ZIP">
              <span class="icon">üóÇÔ∏è</span><span>–°–∫–∞—á–∞—Ç—å ZIP</span>
            </a>
          </div>
        </div>
        {% endfor %}
      </div>
    {% endif %}
  </div>
</body>
</html>
